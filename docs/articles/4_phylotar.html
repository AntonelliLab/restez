<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
<ol start="4" style="list-style-type: decimal">
<li>Running phylotaR with restez</li>
</ol> • restez</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="&lt;ol start=" style="list-style-type: decimal">
</head>
<body>
<li>Running phylotaR with restez</li>
" /&gt;

<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">restez</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/restez.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_rodents.html">1. Build a database of all rodents</a>
    </li>
    <li>
      <a href="../articles/2_search_and_fetch.html">2. How to search for and fetch sequences</a>
    </li>
    <li>
      <a href="../articles/3_parsing.html">3. Advanced parsing of a GenBank record</a>
    </li>
    <li>
      <a href="../articles/4_phylotar.html">4. Running phylotaR with restez</a>
    </li>
    <li>
      <a href="../articles/5_tips_and_tricks.html">5. Tips and Tricks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/restez#readme">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1><ol start="4" style="list-style-type: decimal">
<li>Running phylotaR with restez</li>
</ol></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/restez#readme/blob/master/vignettes/4_phylotar.Rmd"><code>vignettes/4_phylotar.Rmd</code></a></small>
      <div class="hidden name"><code>4_phylotar.Rmd</code></div>

    </div>

    
    
<p>In this tutorial we will showcase how a <code>restez</code> database can be used to speed up a <a href="https://github.com/ropensci/phylotaR">phylotaR</a> run. <code>phylotaR</code> runs an automated pipeline for identifying ortholgous gene clusters as the first step in a phylogenetic analysis. A user provides a taxonomic identity and the pipeline downloads all relevant sequences and identifies clusters using a local-alignment search tool. For more information on <code>phylotaR</code> see its <a href="https://doi.org/10.3390/life8020020">published article</a>.</p>
<p>By using <code>restez</code> in conjunction with <code>phylotaR</code>, we will not only being saving time, but also improving the chances of a successful <code>phylotaR</code> run – often NCBI Entrez limits the number of requests or even rejects requests from IP addresses that are making too many. Note, however, that the gains in using <code>restez</code> with <code>phylotaR</code> only make sense if you make use of the <code>restez</code> database multiple times or if you wish to radically increase the maximum number of sequences to download per taxon (by default it is only 3,000). Also, note that using a <code>restez</code> database does not currently eliminate the need for an internet connection. <code>phylotaR</code> still needs to look up taxonomic information and must also identify relevant sequence IDs using Entrez (this may change in the future as <code>restez</code> develops).</p>
<p>We will run a <code>phylotaR</code> run for the rodent subfamily, Dipodinae, the clade that contains jerboas. Because this clade is so small, it should not take too long to run it. We will, however, limit to showcasing only the download stage of the <code>phylotaR</code> pipeline, where <code>restez</code> is required.</p>
<div id="install-phylotar" class="section level2">
<h2 class="hasAnchor">
<a href="#install-phylotar" class="anchor"></a>Install phylotaR</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Currently only a specific version of phylotaR can work with restez</span>
<span class="co"># It must be installed from GitHub using devtools, restez branch</span>
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="dt">repo =</span> <span class="st">'ropensci/phylotaR'</span>, <span class="dt">ref =</span> <span class="st">'restez'</span>)</code></pre></div>
</div>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>Since we will be running the <code>phylotaR</code> pipeline for Dipodinae, we can use the rodents database we created <a href="https://ropensci.github.io/restez/articles/1_rodents.html">before</a>. We do not need to set-up the <code>phylotaR</code> pipeline any differently with a <code>restez</code> database, except to ensure we have set the <code>restez</code> path to the rodent database. (Connections to the <code>restez</code> database will be made automatically, <code>restez_connect</code> or <code>restez_disconnect</code> do not need to be run.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(phylotaR)

<span class="co"># Restez (no need to call package)</span>
restez<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/restez/topics/restez_path_set">restez_path_set</a></span>(<span class="dt">filepath =</span> rodents_path)

<span class="co"># Vars</span>
wd &lt;-<span class="st"> 'dipodinae'</span>
<span class="kw">dir.create</span>(wd)
txid &lt;-<span class="st"> </span><span class="dv">35737</span>  <span class="co"># Dipodinae</span>
mxsql &lt;-<span class="st"> </span><span class="dv">500</span>
ncbi_dr &lt;-<span class="st"> '[PATH/TO/BLAST]'</span> <span class="co"># e.g. '/usr/local/ncbi/blast/bin'</span>

<span class="co"># setup</span>
<span class="kw"><a href="../reference/setup.html">setup</a></span>(<span class="dt">wd =</span> wd, <span class="dt">txid =</span> txid, <span class="dt">ncbi_dr =</span> ncbi_dr, <span class="dt">mxsql =</span> <span class="dv">500</span>)</code></pre></div>
</div>
<div id="run" class="section level2">
<h2 class="hasAnchor">
<a href="#run" class="anchor"></a>Run</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># run just the first two stages for this demonstration</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/phylotaR/topics/taxise_run">taxise_run</a></span>(wd)
<span class="co">#&gt; --------------------------------------------</span>
<span class="co">#&gt; Starting stage TAXISE: [2018-11-15 14:05:07]</span>
<span class="co">#&gt; --------------------------------------------</span>
<span class="co">#&gt; Searching taxonomic IDs ...</span>
<span class="co">#&gt; Downloading taxonomic records ...</span>
<span class="co">#&gt; . [1-25]</span>
<span class="co">#&gt; Generating taxonomic dictionary ...</span>
<span class="co">#&gt; ---------------------------------------------</span>
<span class="co">#&gt; Completed stage TAXISE: [2018-11-15 14:05:11]</span>
<span class="co">#&gt; ---------------------------------------------</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/phylotaR/topics/download_run">download_run</a></span>(wd)
<span class="co">#&gt; ----------------------------------------------</span>
<span class="co">#&gt; Starting stage DOWNLOAD: [2018-11-15 14:05:11]</span>
<span class="co">#&gt; ----------------------------------------------</span>
<span class="co">#&gt; Identifying suitable clades ...</span>
<span class="co">#&gt; Identified [1] suitable clades.</span>
<span class="co">#&gt; Downloading hierarchically ...</span>
<span class="co">#&gt; Working on parent [id 35737]: [1/1] ...</span>
<span class="co">#&gt; . + whole subtree ...</span>
<span class="co">#&gt; . . Getting [100 sqs] ...</span>
<span class="co">#&gt; . . . [1-100]</span>
<span class="co">#&gt; Successfully downloaded [99 sqs] in total.</span>
<span class="co">#&gt; -----------------------------------------------</span>
<span class="co">#&gt; Completed stage DOWNLOAD: [2018-11-15 14:05:22]</span>
<span class="co">#&gt; -----------------------------------------------</span></code></pre></div>
<p>Sequences that cannot be found locally will be downloaded via Entrez. Sequences may not be found locally for three sets of reasons, 1. <code>phylotaR</code> may have identified non-GenBank sequences (e.g. RefSeq), 2. the local database may have size limits (ours has a min of 100 and a max 1000), and 3. the local database is out of date, new GenBank releases are only made once a month.</p>
<blockquote>
<p>Note: If the <code>phylotaR</code> messages do not explicit state that they are using a <code>restez</code> database, then, you may not have set the <code>restez</code> path.</p>
</blockquote>
<p>Compared to running without a <code>restez</code> database, phylotaR download can run <a href="https://github.com/ropensci/restez/blob/master/other/phylotar_demo.R"><strong>2x</strong> faster</a>.</p>
</div>
<div id="next-up" class="section level2">
<h2 class="hasAnchor">
<a href="#next-up" class="anchor"></a>Next up</h2>
<p><strong><a href="https://ropensci.github.io/restez/articles/5_tips_and_tricks.html">Tips and tricks</a></strong></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#install-phylotar">Install phylotaR</a></li>
      <li><a href="#setup">Setup</a></li>
      <li><a href="#run">Run</a></li>
      <li><a href="#next-up">Next up</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Dom Bennett.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  
</body>
</html>
